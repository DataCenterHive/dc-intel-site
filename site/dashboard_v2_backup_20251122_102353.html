<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DC Intel Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #f5f5dc;
            font-family: Georgia, 'Times New Roman', Times, serif;
            color: #000;
            padding: 20px;
        }

        .newspaper-container {
            max-width: 1200px;
            margin: 0 auto;
            background: #fff;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .masthead {
            text-align: center;
            border-bottom: 4px double #000;
            padding-bottom: 20px;
            margin-bottom: 15px;
            position: relative;
        }

        .masthead h1 {
            font-size: 16px;
            font-weight: bold;
            letter-spacing: 3px;
            font-family: Arial, Helvetica, sans-serif;
        }

        .masthead .tagline {
            font-size: 13px;
            font-style: italic;
            margin-top: 8px;
            color: #333;
        }

        .auth-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: row;
            gap: 10px;
        }

        .auth-btn {
            padding: 8px 16px;
            background: #000;
            color: #fff;
            border: 2px solid #000;
            font-family: Georgia, serif;
            font-size: 12px;
            cursor: pointer;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s;
        }

        .auth-btn:hover {
            background: #fff;
            color: #000;
        }

        .auth-btn.secondary {
            background: #fff;
            color: #000;
        }

        .auth-btn.secondary:hover {
            background: #000;
            color: #fff;
        }

        .user-info {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 12px;
            padding: 8px 16px;
            background: #f0f0f0;
            border: 2px solid #000;
        }

        .user-info strong {
            font-weight: bold;
        }

        .logout-btn {
            margin-left: 10px;
            padding: 4px 10px;
            background: #000;
            color: #fff;
            border: 1px solid #000;
            cursor: pointer;
            font-size: 10px;
        }

        .logout-btn:hover {
            background: #333;
        }

        .edition-info {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            font-size: 11px;
            margin-bottom: 20px;
            padding: 5px 0;
            border-bottom: 1px solid #ccc;
        }

        .edition-date {
            font-weight: bold;
            text-align: left;
        }

        .navigation {
            text-align: center;
            font-size: 12px;
            font-weight: bold;
        }

        .navigation a {
            color: #000;
            text-decoration: none;
            padding: 5px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .navigation a:hover {
            border-bottom: 2px solid #000;
        }

        .navigation a.active {
            border-bottom: 2px solid #000;
        }

        .api-status {
            text-align: right;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .search-box-container {
            background: #f9f9f9;
            border: 2px solid #000;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .search-box-container h3 {
            font-size: 18px;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .search-input-wrapper {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }

        #searchInput {
            flex: 1;
            padding: 12px;
            font-family: Georgia, serif;
            font-size: 14px;
            border: 1px solid #333;
        }

        #searchBtn {
            padding: 12px 30px;
            background: #000;
            color: #fff;
            border: none;
            font-family: Georgia, serif;
            font-size: 14px;
            cursor: pointer;
            font-weight: bold;
        }

        #searchBtn:hover {
            background: #333;
        }

        .quick-queries {
            margin-top: 10px;
            font-size: 11px;
        }

        .quick-queries a {
            color: #000;
            text-decoration: underline;
            margin: 0 10px;
            cursor: pointer;
        }

        .quick-queries a:hover {
            color: #666;
        }

        .columns {
            column-count: 2;
            column-gap: 30px;
            column-rule: 1px solid #ccc;
            text-align: justify;
            line-height: 1.6;
        }

        .headline-main {
            column-span: all;
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 3px solid #000;
            padding-bottom: 10px;
        }

        .article {
            break-inside: avoid;
            margin-bottom: 25px;
        }

        .article-headline {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
            text-align: center;
        }

        .article-byline {
            font-size: 10px;
            font-style: italic;
            color: #666;
            margin-bottom: 8px;
            text-align: center;
        }

        .article-content {
            font-size: 13px;
            line-height: 1.7;
        }

        .classifieds {
            column-span: all;
            background: #fffef0;
            border: 1px solid #000;
            padding: 15px;
            margin-top: 30px;
        }

        .classifieds h3 {
            font-size: 18px;
            text-transform: uppercase;
            text-align: center;
            border-bottom: 2px double #000;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }

        .classifieds-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            font-size: 11px;
        }

        .classified-item {
            border: 1px solid #ccc;
            padding: 10px;
            background: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .classified-item:hover {
            background: #f0f0f0;
            border-color: #000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .classified-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        /* Modal Popup Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: #fff;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            border: 4px solid #000;
            position: relative;
            font-family: Georgia, serif;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 30px;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: bold;
        }

        .modal-close:hover {
            color: #666;
        }

        .modal-content h2 {
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }

        .modal-content ul {
            list-style: disc;
            margin-left: 20px;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .modal-btn {
            background: #000;
            color: #fff;
            padding: 12px 30px;
            border: 2px solid #000;
            font-family: Georgia, serif;
            font-size: 14px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
        }

        .modal-btn:hover {
            background: #fff;
            color: #000;
        }

        .ticker {
            background: #000;
            color: #fff;
            padding: 10px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            overflow: hidden;
            white-space: nowrap;
        }

        .ticker-content {
            display: inline-block;
            padding-left: 100%;
            animation: ticker 30s linear infinite;
        }

        @keyframes ticker {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        .weather-box {
            column-span: all;
            background: #e8e8e8;
            border: 2px solid #000;
            padding: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 12px;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            font-size: 24px;
            font-weight: bold;
        }

        /* Knowledge section - newspaper clipping style */
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .knowledge-card {
            background: #fffef5; /* Aged paper color */
            border: 2px solid #000;
            padding: 15px;
            box-shadow:
                3px 3px 6px rgba(0,0,0,0.3),
                inset 0 0 20px rgba(0,0,0,0.05);
            position: relative;
            transition: all 0.3s ease;
        }

        .knowledge-card:nth-child(3n+1) {
            transform: rotate(-0.5deg);
        }

        .knowledge-card:nth-child(3n+2) {
            transform: rotate(0.8deg);
        }

        .knowledge-card:nth-child(3n+3) {
            transform: rotate(-1deg);
        }

        .knowledge-card:hover {
            transform: rotate(0deg) scale(1.02);
            box-shadow:
                5px 5px 12px rgba(0,0,0,0.4),
                inset 0 0 30px rgba(0,0,0,0.08);
            z-index: 10;
        }

        .knowledge-card h4 {
            font-size: 16px;
            margin-bottom: 10px;
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(0,0,0,0.03);
            margin: -15px -15px 10px -15px;
            padding: 12px 15px 8px 15px;
        }

        .knowledge-card p {
            font-size: 12px;
            line-height: 1.6;
            text-align: justify;
            margin-top: 10px;
        }

        /* Knowledge tabs */
        .knowledge-tab {
            font-family: 'Arial Black', sans-serif;
            font-size: 14px;
            font-weight: bold;
            padding: 10px 20px;
            border: 2px solid #000;
            background: #f5f5f0;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .knowledge-tab:hover {
            background: #e0e0d8;
            transform: translateY(-2px);
            box-shadow: 2px 4px 6px rgba(0,0,0,0.3);
        }

        .knowledge-tab.active-tab {
            background: #000;
            color: #fff;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* Taxonomy cards */
        .taxonomy-card {
            background: #fffef5;
            border: 2px solid #000;
            padding: 20px;
            box-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            transform: rotate(-0.5deg);
            transition: all 0.3s ease;
        }

        .taxonomy-card:hover {
            transform: rotate(0deg) scale(1.02);
            box-shadow: 5px 5px 12px rgba(0,0,0,0.4);
            z-index: 10;
        }

        .taxonomy-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 3px double #000;
            padding-bottom: 10px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .taxonomy-item {
            padding: 8px;
            border-bottom: 1px dotted #666;
            font-size: 13px;
            line-height: 1.6;
        }

        .taxonomy-item:last-child {
            border-bottom: none;
        }

        /* Services section */
        .subscription-plans {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .plan-card {
            background: #fffef5;
            border: 3px double #000;
            padding: 20px;
            text-align: center;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
        }

        .plan-card h3 {
            font-size: 22px;
            margin-bottom: 10px;
            text-transform: uppercase;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }

        .plan-price {
            font-size: 36px;
            font-weight: bold;
            margin: 20px 0;
        }

        .plan-price small {
            font-size: 14px;
            font-weight: normal;
        }

        .plan-features {
            text-align: left;
            margin: 20px 0;
            font-size: 13px;
            line-height: 1.8;
        }

        .plan-features li {
            margin-bottom: 8px;
        }

        .plan-btn {
            width: 100%;
            padding: 12px;
            background: #000;
            color: #fff;
            border: 2px solid #000;
            font-family: Georgia, serif;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        .plan-btn:hover {
            background: #fff;
            color: #000;
        }

        .services-list {
            display: grid;
            gap: 20px;
        }

        .service-item {
            border-left: 4px solid #000;
            padding-left: 20px;
        }

        .service-item h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .service-item p {
            font-size: 14px;
            line-height: 1.7;
        }

        /* Heatmap for Existing DCs */
        .heatmap-container {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            justify-items: center;
            max-width: 100%;
            margin-left: auto;
            margin-right: auto;
        }

        .heatmap-cell {
            background: #f0f0f0;
            border: 1px solid #000;
            padding: 10px;
            text-align: center;
            font-size: 11px;
            transition: all 0.3s;
            min-width: 100px;
            width: 100%;
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .heatmap-cell.heat-low {
            background: #d4f1d4;
        }

        .heatmap-cell.heat-medium {
            background: #fff4b3;
        }

        .heatmap-cell.heat-high {
            background: #ffcccc;
        }

        .heatmap-cell.heat-extreme {
            background: #ff6666;
            color: #fff;
            font-weight: bold;
        }

        .heatmap-label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .heatmap-value {
            font-size: 16px;
            font-weight: bold;
        }

        /* Modal System */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: #fffef5;
            border: 4px double #000;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 5px 5px 20px rgba(0,0,0,0.5);
            position: relative;
        }

        .modal-header {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            border-bottom: 3px solid #000;
            padding-bottom: 10px;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 13px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            font-family: Georgia, serif;
            font-size: 13px;
            border: 2px solid #000;
            background: #fff;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-submit {
            width: 100%;
            padding: 12px;
            background: #000;
            color: #fff;
            border: 2px solid #000;
            font-family: Georgia, serif;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        .form-submit:hover {
            background: #333;
        }

        @media print {
            .search-box-container, .ticker, #searchBtn, .navigation { display: none; }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">Loading Latest Intelligence...</div>
    </div>

    <div class="newspaper-container">
        <div class="masthead">
            <div class="auth-buttons" id="authButtons">
                <button class="auth-btn secondary" onclick="showLogin()">Sign In</button>
                <button class="auth-btn" onclick="showRegister()">Register</button>
            </div>
            <div class="user-info" id="userInfo" style="display: none;">
                Welcome, <strong id="userName">User</strong>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
            <h1>DC-INTEL DASHBOARD</h1>
            <div class="tagline">"Your Trusted Source for Data Center Brokerage & Market Intelligence"</div>
        </div>

        <div class="edition-info">
            <div class="edition-date">Daily Edition â€¢ <span id="todayDate"></span></div>
            <div class="navigation">
                <a href="#" onclick="window.location.reload(); return false;" class="active" id="navHome">Home</a> |
                <a href="#" onclick="switchSection('knowledge'); return false;" id="navKnowledge">Knowledge</a> |
                <a href="#" onclick="switchSection('services'); return false;" id="navServices">Services</a> |
                <a href="#" onclick="switchSection('existing-dcs'); return false;" id="navExisting">Existing DCs</a> |
                <a href="#" onclick="switchSection('upcoming-dcs'); return false;" id="navUpcoming">Upcoming DCs</a>
            </div>
            <div class="api-status">API Status: <strong id="apiStatus">ONLINE</strong></div>
        </div>

        <!-- HOME SECTION -->
        <div class="content-section active" id="homeSection">
            <div class="search-box-container">
                <h3>DC Intelligence Search Bureau</h3>
                <div class="search-input-wrapper">
                    <input type="text" id="searchInput" placeholder="Search data center projects, operators, locations...">
                    <button id="searchBtn">Search</button>
                </div>
                <div class="quick-queries">
                    Quick Queries:
                    <a onclick="doSearch('hyperscale')">Hyperscale</a> |
                    <a onclick="doSearch('colocation')">Colocation</a> |
                    <a onclick="doSearch('edge computing')">Edge</a> |
                    <a onclick="doSearch('100MW projects')">100MW+</a> |
                    <a onclick="document.getElementById('contentArea').scrollIntoView({behavior: 'smooth'}); return false;">Latest News</a>
                </div>
            </div>

            <div id="contentArea" class="columns">
                <div class="headline-main" id="dailyHeadline">
                    Data Center Construction Booms Across Nation
                </div>

                <div class="article" id="article1">
                    <div class="article-headline">Loading...</div>
                    <div class="article-byline">DC Intel</div>
                    <div class="article-content">Loading content...</div>
                </div>

                <div class="article" id="article2">
                    <div class="article-headline">Loading...</div>
                    <div class="article-byline">DC Intel</div>
                    <div class="article-content">Loading content...</div>
                </div>

                <div class="weather-box">
                    <strong>DC MARKET HEAT INDEX:</strong> EXTREMELY HOT ðŸ”¥ |
                    <strong>Top Markets:</strong> Ashburn VA, Dallas TX, Phoenix AZ |
                    <strong>Trend:</strong> Accelerating
                </div>
            </div>

            <div class="classifieds" id="classifiedsSection">
                <h3>Professional Services Directory</h3>
                <div class="classifieds-grid" id="classifiedsGrid"></div>
            </div>
        </div>

        <!-- KNOWLEDGE SECTION -->
        <div class="content-section" id="knowledgeSection">
            <h2 style="text-align: center; margin-bottom: 20px; border-bottom: 3px solid #000; padding-bottom: 10px;">Data Center Knowledge Base</h2>

            <!-- Knowledge Tabs -->
            <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #000; padding-bottom: 5px;">
                <button onclick="switchKnowledgeTab('glossary')" id="tabGlossary" class="knowledge-tab active-tab">
                    GLOSSARY
                </button>
                <button onclick="switchKnowledgeTab('handbook')" id="tabHandbook" class="knowledge-tab">
                    HANDBOOK
                </button>
                <button onclick="switchKnowledgeTab('taxonomy')" id="tabTaxonomy" class="knowledge-tab">
                    TAXONOMY
                </button>
            </div>

            <!-- Glossary View -->
            <div id="glossaryView" class="knowledge-view">
                <input type="text" id="knowledgeSearch" placeholder="Search glossary terms..." style="width: 100%; padding: 12px; margin-bottom: 20px; border: 2px solid #000; font-family: Georgia, serif;">
                <div class="knowledge-grid" id="knowledgeGrid"></div>
            </div>

            <!-- Handbook View -->
            <div id="handbookView" class="knowledge-view" style="display: none;">
                <div id="handbookContent" style="background: #fffef5; border: 3px double #000; padding: 30px; max-width: 900px; margin: 0 auto; line-height: 1.8; font-size: 14px; box-shadow: 3px 3px 8px rgba(0,0,0,0.3);">
                    <p style="text-align: center; font-style: italic;">Loading handbook...</p>
                </div>
            </div>

            <!-- Taxonomy View -->
            <div id="taxonomyView" class="knowledge-view" style="display: none;">
                <div id="taxonomyContent" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;"></div>
            </div>
        </div>

        <!-- SERVICES SECTION -->
        <div class="content-section" id="servicesSection">
            <h2 style="text-align: center; margin-bottom: 30px; border-bottom: 3px solid #000; padding-bottom: 10px;">Our Professional Services</h2>

            <h3 style="text-align: center; margin-bottom: 20px; font-size: 20px;">Subscription Plans</h3>
            <div class="subscription-plans">
                <div class="plan-card">
                    <h3>Basic</h3>
                    <div class="plan-price">$499<small>/month</small></div>
                    <ul class="plan-features">
                        <li>âœ“ Access to 50,000 permits</li>
                        <li>âœ“ Basic search & filters</li>
                        <li>âœ“ Weekly email updates</li>
                        <li>âœ“ Export to CSV</li>
                        <li>âœ“ 3 saved searches</li>
                        <li>âœ“ Email support</li>
                    </ul>
                    <button class="plan-btn" onclick="showPremiumData()">Get Started</button>
                </div>
                <div class="plan-card">
                    <h3>Professional</h3>
                    <div class="plan-price">$1,499<small>/month</small></div>
                    <ul class="plan-features">
                        <li>âœ“ Full database access (700K+ permits)</li>
                        <li>âœ“ Advanced analytics</li>
                        <li>âœ“ Daily email alerts</li>
                        <li>âœ“ Export to Excel/PDF</li>
                        <li>âœ“ Unlimited saved searches</li>
                        <li>âœ“ Priority support</li>
                        <li>âœ“ API access (5K calls/mo)</li>
                    </ul>
                    <button class="plan-btn" onclick="showPremiumData()">Get Started</button>
                </div>
                <div class="plan-card">
                    <h3>Enterprise</h3>
                    <div class="plan-price">$4,999<small>/month</small></div>
                    <ul class="plan-features">
                        <li>âœ“ Everything in Professional</li>
                        <li>âœ“ Unlimited API calls</li>
                        <li>âœ“ Custom data feeds</li>
                        <li>âœ“ Dedicated account manager</li>
                        <li>âœ“ White-label options</li>
                        <li>âœ“ Custom integrations</li>
                        <li>âœ“ Quarterly strategy sessions</li>
                    </ul>
                    <button class="plan-btn" onclick="showPremiumData()">Contact Sales</button>
                </div>
            </div>

            <h3 style="text-align: center; margin: 40px 0 20px; font-size: 20px;">All Services</h3>
            <div class="services-list" id="servicesList"></div>
        </div>

        <!-- EXISTING DCS SECTION -->
        <div class="content-section" id="existingDCsSection">
            <h2 style="text-align: center; margin-bottom: 20px; border-bottom: 3px solid #000; padding-bottom: 10px;">Existing Data Centers Database</h2>

            <!-- Tabs for Existing DCs -->
            <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #ccc;">
                <a href="#" onclick="showExistingTab('heatmap'); return false;" id="existingTabHeatmap" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #000; text-decoration: none; border-bottom: 3px solid #000;">Heatmap</a>
                <a href="#" onclick="showExistingTab('table'); return false;" id="existingTabTable" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #666; text-decoration: none; border-bottom: 3px solid transparent;">Table View</a>
                <a href="#" onclick="showExistingTab('contact'); return false;" id="existingTabContact" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #666; text-decoration: none; border-bottom: 3px solid transparent;">Request Data</a>
            </div>

            <div id="existingTabHeatmapContent" style="display: block;">
                <div id="heatmapViz" class="heatmap-container"></div>
            </div>

            <div id="existingTabTableContent" style="display: none;">
                <div style="background: #f9f9f9; padding: 20px; border: 2px solid #000;">
                    <p style="text-align: center; margin-bottom: 15px;">Comprehensive table view of all existing data centers</p>
                    <div id="existingDCsTableView"></div>
                </div>
            </div>

            <div id="existingTabContactContent" style="display: none;">
                <div style="max-width: 600px; margin: 0 auto; background: #f9f9f9; padding: 30px; border: 2px solid #000;">
                    <h3 style="text-align: center; margin-bottom: 20px;">Request Existing DC Data</h3>
                    <form onsubmit="handleServiceRequest(event, 'Existing DC Data')">
                        <div class="form-group">
                            <label>Your Name</label>
                            <input type="text" name="name" required>
                        </div>
                        <div class="form-group">
                            <label>Company</label>
                            <input type="text" name="company" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" name="phone">
                        </div>
                        <div class="form-group">
                            <label>Specific Requirements</label>
                            <textarea name="requirements" rows="4" placeholder="Tell us what specific data or regions you're interested in..."></textarea>
                        </div>
                        <button type="submit" class="form-submit">Submit Request</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- UPCOMING DCS SECTION -->
        <div class="content-section" id="upcomingDCsSection">
            <h2 style="text-align: center; margin-bottom: 20px; border-bottom: 3px solid #000; padding-bottom: 10px;">Upcoming Data Center Projects</h2>
            <p style="text-align: center; margin-bottom: 20px; font-size: 13px;">Intelligence gathered from industry news sources and public construction permits nationwide</p>

            <!-- Tabs for Upcoming DCs -->
            <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #ccc;">
                <a href="#" onclick="showUpcomingTab('heatmap'); return false;" id="upcomingTabHeatmap" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #000; text-decoration: none; border-bottom: 3px solid #000;">Heatmap</a>
                <a href="#" onclick="showUpcomingTab('table'); return false;" id="upcomingTabTable" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #666; text-decoration: none; border-bottom: 3px solid transparent;">Project Table</a>
                <a href="#" onclick="showUpcomingTab('contact'); return false;" id="upcomingTabContact" style="display: inline-block; padding: 10px 20px; margin: 0 5px; font-weight: bold; color: #666; text-decoration: none; border-bottom: 3px solid transparent;">Request Data</a>
            </div>

            <div id="upcomingTabHeatmapContent" style="display: block;">
                <div id="upcomingHeatmap" class="heatmap-container"></div>
            </div>

            <div id="upcomingTabTableContent" style="display: none;">
                <h3 style="text-align: center; margin: 20px 0 15px; font-size: 16px;">Project Details</h3>
                <div id="upcomingDCsTable" style="background: #f9f9f9; padding: 20px; border: 2px solid #000; overflow-x: auto;"></div>
            </div>

            <div id="upcomingTabContactContent" style="display: none;">
                <div style="max-width: 600px; margin: 0 auto; background: #f9f9f9; padding: 30px; border: 2px solid #000;">
                    <h3 style="text-align: center; margin-bottom: 20px;">Request Upcoming DC Project Data</h3>
                    <form onsubmit="handleServiceRequest(event, 'Upcoming DC Projects')">
                        <div class="form-group">
                            <label>Your Name</label>
                            <input type="text" name="name" required>
                        </div>
                        <div class="form-group">
                            <label>Company</label>
                            <input type="text" name="company" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" name="phone">
                        </div>
                        <div class="form-group">
                            <label>Project Focus Areas</label>
                            <textarea name="requirements" rows="4" placeholder="Tell us what regions, project types, or specific information you need..."></textarea>
                        </div>
                        <button type="submit" class="form-submit">Submit Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- LOGIN MODAL -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('loginModal')">&times;</span>
            <div class="modal-header">Sign In</div>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required>
                </div>
                <button type="submit" class="form-submit">Sign In</button>
            </form>
        </div>
    </div>

    <!-- REGISTER MODAL -->
    <div class="modal-overlay" id="registerModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('registerModal')">&times;</span>
            <div class="modal-header">Register</div>
            <form id="registerForm" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Company</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required minlength="8">
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" name="confirm_password" required>
                </div>
                <button type="submit" class="form-submit">Register</button>
            </form>
        </div>
    </div>

    <!-- SERVICE REQUEST MODALS -->
    <div class="modal-overlay" id="serviceModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('serviceModal')">&times;</span>
            <div class="modal-header" id="serviceModalTitle">Request Service</div>
            <form id="serviceForm" onsubmit="handleServiceRequest(event)">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Company</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Details</label>
                    <textarea name="details" rows="4" placeholder="Please provide details about your requirements..."></textarea>
                </div>
                <button type="submit" class="form-submit">Submit Request</button>
            </form>
        </div>
    </div>

    <div class="ticker">
        <div class="ticker-content" id="tickerContent">
            LATEST: Google announces Virginia expansion â€¢ AWS Dallas project valued at $500M â€¢ Equinix opens new Ashburn facility â€¢ Microsoft Azure capacity doubles in Phoenix â€¢ QTS reports record quarter â€¢ Switch announces Nevada mega-campus â€¢ Approximately 700,000 permits tracked nationwide â€¢ Over 1,000 confirmed data center projects â€¢ Real-time intelligence via DC Intel API
        </div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8010';
        const API_KEY = 'keepongoing';

        // Authentication functions
        function showLogin() {
            document.getElementById('loginModal').classList.add('active');
        }

        function showRegister() {
            document.getElementById('registerModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        async function handleLogin(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);

            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': API_KEY
                    },
                    body: JSON.stringify({
                        email: formData.get('email'),
                        password: formData.get('password')
                    })
                });

                const data = await response.json();

                if (data.ok || data.token) {
                    localStorage.setItem('dc_intel_token', data.token);
                    localStorage.setItem('dc_intel_user', JSON.stringify(data.user));
                    updateAuthUI(data.user);
                    closeModal('loginModal');
                    alert('Welcome back! You have successfully signed in.');
                } else {
                    alert(data.error || 'Login failed. Please check your credentials.');
                }
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed. This feature requires server implementation.');
            }
        }

        async function handleRegister(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);

            if (formData.get('password') !== formData.get('confirm_password')) {
                alert('Passwords do not match!');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': API_KEY
                    },
                    body: JSON.stringify({
                        name: formData.get('name'),
                        email: formData.get('email'),
                        company: formData.get('company'),
                        password: formData.get('password')
                    })
                });

                const data = await response.json();

                if (data.ok || data.token) {
                    localStorage.setItem('dc_intel_token', data.token);
                    localStorage.setItem('dc_intel_user', JSON.stringify(data.user));
                    updateAuthUI(data.user);
                    closeModal('registerModal');
                    alert('Registration successful! Welcome to DC Intel.');
                } else {
                    alert(data.error || 'Registration failed. Please try again.');
                }
            } catch (error) {
                console.error('Registration error:', error);
                alert('Registration failed. This feature requires server implementation.');
            }
        }

        function logout() {
            localStorage.removeItem('dc_intel_token');
            localStorage.removeItem('dc_intel_user');
            updateAuthUI(null);
            alert('You have been logged out.');
        }

        function updateAuthUI(user) {
            const authButtons = document.getElementById('authButtons');
            const userInfo = document.getElementById('userInfo');

            if (user) {
                authButtons.style.display = 'none';
                userInfo.style.display = 'block';
                document.getElementById('userName').textContent = user.name || user.email;
            } else {
                authButtons.style.display = 'flex';
                userInfo.style.display = 'none';
            }
        }

        // Check for existing session on load
        (function checkAuth() {
            const token = localStorage.getItem('dc_intel_token');
            const userStr = localStorage.getItem('dc_intel_user');
            if (token && userStr) {
                try {
                    const user = JSON.parse(userStr);
                    updateAuthUI(user);
                } catch (e) {
                    localStorage.removeItem('dc_intel_token');
                    localStorage.removeItem('dc_intel_user');
                }
            }
        })();

        // Set today's date
        function updateDate() {
            const dateStr = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('todayDate').textContent = dateStr;
            document.querySelectorAll('.article-date').forEach(el => {
                el.textContent = new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            });
        }
        updateDate();

        // Load daily AI-generated content from JSON
        async function generateDailyContent() {
            try {
                // Load daily snippets from JSON file with cache busting
                const timestamp = new Date().getTime();
                const response = await fetch(`daily_articles.json?t=${timestamp}`);

                if (!response.ok) {
                    console.error('Could not load daily articles, using fallback');
                    loadFallbackContent();
                    return;
                }

                const data = await response.json();

                // Update main headline (rotate from pool)
                const headlines = [
                    "Data Center Construction Booms Across Nation",
                    "Northern Virginia Maintains DC Dominance",
                    "Hyperscale Investment Reaches Record Highs",
                    "AI Drives Unprecedented DC Capacity Demand",
                    "Power Constraints Shape New DC Strategies",
                    "Colocation Market Shows Strong Growth",
                    "Edge Computing Deployments Accelerate"
                ];
                const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
                document.getElementById('dailyHeadline').textContent = headlines[dayOfYear % headlines.length];

                // Load AI-generated articles
                const articles = data.articles || [];

                if (articles.length >= 2) {
                    document.getElementById('article1').innerHTML = `
                        <div class="article-headline">${articles[0].headline}</div>
                        <div class="article-byline">DC Intel News Desk â€¢ <span class="article-date"></span></div>
                        <div class="article-content">${articles[0].content}</div>
                    `;

                    document.getElementById('article2').innerHTML = `
                        <div class="article-headline">${articles[1].headline}</div>
                        <div class="article-byline">Market Intelligence â€¢ <span class="article-date"></span></div>
                        <div class="article-content">${articles[1].content}</div>
                    `;

                    console.log(`Loaded AI-generated articles from ${data.generated_date}`);
                } else {
                    loadFallbackContent();
                }

                updateDate(); // Update article dates

                // Populate classifieds section
                populateClassifieds();

            } catch (error) {
                console.error('Error loading daily articles:', error);
                loadFallbackContent();
            }
        }

        // Populate Professional Services Directory
        function populateClassifieds() {
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);

            // SERVICES (rotating 2 per day)
            const services = [
                {
                    type: "service",
                    title: "FACILITY SERVICES: Buy/Sell/Lease DC Assets",
                    desc: "Professional transaction advisory for data center acquisitions, dispositions, and leasing. Market expertise across hyperscale, colocation, and enterprise facilities. Confidential representation for buyers and sellers.",
                    link: "service_facility_services.html"
                },
                {
                    type: "service",
                    title: "MARKET INTELLIGENCE: Real-Time Data",
                    desc: "Comprehensive tracking of 1,000+ DC projects nationwide. Daily updates on permits, construction activity, and operator movements. Historical data, trend analysis, and competitive intelligence. CSV exports and API access available.",
                    link: "service_market_intelligence.html"
                },
                {
                    type: "service",
                    title: "SITE SELECTION: Expert Consulting",
                    desc: "Data-driven location analysis for new DC development. Market opportunity assessment, operator presence analysis, and growth trajectory forecasting. Identify optimal markets based on permit activity, capacity trends, and competitive positioning.",
                    link: "service_site_selection.html"
                },
                {
                    type: "service",
                    title: "DUE DILIGENCE: Asset Assessment",
                    desc: "Comprehensive technical and financial review of DC assets for investors and acquirers. Infrastructure analysis, market positioning, financial modeling, and risk assessment. Detailed reporting with actionable recommendations.",
                    link: "service_due_diligence.html"
                }
            ];

            // MARKET INSIGHTS (rotating 1 per day)
            const marketInsights = [
                {
                    type: "insight",
                    title: "ðŸ”¥ PHOENIX MARKET UPDATE",
                    desc: "Arizona leads western expansion with 47 new DC permit filings in Q3 2025. Mesa and Chandler driving growth with hyperscale activity. Average project valuation: $85M. Tracking 156 active projects statewide.",
                    link: "#"
                },
                {
                    type: "insight",
                    title: "ðŸ“Š NORTHERN VIRGINIA DOMINANCE",
                    desc: "Loudoun & Fairfax counties account for 23% of all U.S. DC construction. 89 active projects totaling 450MW capacity. Microsoft, AWS, Google remain top operators. Historical data shows 5-year CAGR of 18%.",
                    link: "#"
                },
                {
                    type: "insight",
                    title: "âš¡ DALLAS WHOLESALE SURGE",
                    desc: "DFW metro sees 34 projects under construction, up 42% YoY. Wholesale colocation expansion dominates with QTS, CyrusOne, EdgeCore leading permits. Richardson and Irving hotspots for new development.",
                    link: "#"
                },
                {
                    type: "insight",
                    title: "ðŸš€ MIDWEST EMERGENCE",
                    desc: "Chicago, Columbus, and Minneapolis show strongest Midwest growth. Combined 67 active projects tracked. Enterprise and edge deployments accelerating. Columbus leads with tax incentives driving 12 new hyperscale permits.",
                    link: "#"
                },
                {
                    type: "insight",
                    title: "ðŸ“ˆ SOUTHEAST EXPANSION",
                    desc: "Atlanta maintains #4 U.S. market position with 42 tracked projects. Charlotte and Richmond emerging as secondary hubs. Georgia incentives attract $2.3B in announced DC investments. Fiber infrastructure upgrades underway.",
                    link: "#"
                },
                {
                    type: "insight",
                    title: "ðŸ’° TEXAS TRIANGLE DOMINANCE",
                    desc: "Dallas, San Antonio, Austin combine for 91 active projects. State leads nation in new MW capacity additions. Power grid improvements accelerate development. Tracking $4.1B in construction value across all 3 metros.",
                    link: "#"
                }
            ];

            // FEATURE UPDATES (rotating 1 per day)
            const featureUpdates = [
                {
                    type: "update",
                    title: "ðŸŒŽ NATIONWIDE COVERAGE: All 50 States",
                    desc: "DC Intel now tracks data center development across all 50 U.S. states. From Alaska to Florida, monitor permits, construction activity, and operator movements nationwide. Complete geographic coverage for comprehensive market intelligence.",
                    link: "#"
                },
                {
                    type: "update",
                    title: "ðŸ†• NEW: Real-Time Permit Alerts",
                    desc: "Get notified within 24 hours of new DC permit filings. Custom alerts by state, city, operator, or project size. Email and webhook delivery available. Never miss a competitive move or market opportunity again.",
                    link: "#"
                },
                {
                    type: "update",
                    title: "ðŸ“Š EXPANDED DATA: Historical to 2020",
                    desc: "Access complete permit history back to 2020 for trend analysis. Track market evolution, operator patterns, and capacity growth over 5 years. Perfect for investment research, competitive intelligence, and market reports.",
                    link: "#"
                },
                {
                    type: "update",
                    title: "ðŸ”Œ API v2: Enterprise Integration",
                    desc: "New RESTful API with real-time data access, webhook subscriptions, and custom query filters. Integrate DC intelligence directly into your platforms, dashboards, and workflows. Documentation and sandbox available.",
                    link: "#"
                },
                {
                    type: "update",
                    title: "ðŸŽ¯ MILESTONE: 1,000+ Projects Tracked",
                    desc: "Our database now tracks over 1,000 data center projects nationwide. Daily updates ensure the most current construction activity, permit status, and operator movements. The industry's most comprehensive DC intelligence platform.",
                    link: "#"
                },
                {
                    type: "update",
                    title: "ðŸ—ºï¸ STATE COVERAGE: From Coast to Coast",
                    desc: "Comprehensive tracking across all major and emerging markets. Primary hubs (VA, TX, AZ, IL, GA) plus secondary markets (NC, OH, OR, WA) and emerging regions. 50-state visibility for complete market awareness.",
                    link: "#"
                }
            ];

            // Daily rotation logic: 2 services + 1 insight + 1 update
            const displayedContent = [];

            // Pick 2 services (rotate through 4)
            const serviceStart = (dayOfYear * 2) % services.length;
            displayedContent.push(services[serviceStart % services.length]);
            displayedContent.push(services[(serviceStart + 1) % services.length]);

            // Pick 1 market insight (rotate through 6)
            const insightIndex = dayOfYear % marketInsights.length;
            displayedContent.push(marketInsights[insightIndex]);

            // Pick 1 feature update (rotate through 6)
            const updateIndex = dayOfYear % featureUpdates.length;
            displayedContent.push(featureUpdates[updateIndex]);

            // Generate HTML for all 4 boxes
            const servicesHTML = displayedContent.map((item, index) => {
                let clickHandler = '';
                let subtitle = '';
                let boxStyle = '';

                if (item.type === 'service') {
                    // Service boxes - link to dedicated pages
                    clickHandler = `onclick="window.location.href='${item.link}'"`;
                    subtitle = '<div style="font-size: 10px; color: #0066cc; margin-top: 5px;">Click to learn more</div>';
                } else if (item.type === 'insight') {
                    // Market insight boxes - different styling (non-clickable for now)
                    clickHandler = '';
                    subtitle = '<div style="font-size: 10px; color: #d97706; margin-top: 5px; font-weight: bold;">ðŸ“Š Market Intelligence</div>';
                    boxStyle = 'border-left: 4px solid #d97706; cursor: default;';
                } else if (item.type === 'update') {
                    // Feature update boxes - different styling (non-clickable for now)
                    clickHandler = '';
                    subtitle = '<div style="font-size: 10px; color: #059669; margin-top: 5px; font-weight: bold;">ðŸš€ Platform Update</div>';
                    boxStyle = 'border-left: 4px solid #059669; cursor: default;';
                }

                return `
                    <div class="classified-item" ${clickHandler} style="${boxStyle}">
                        <div class="classified-title">${item.title}</div>
                        <div>${item.desc}</div>
                        ${subtitle}
                    </div>
                `;
            }).join('');

            document.getElementById('classifiedsGrid').innerHTML = servicesHTML;
        }

        // Modal control functions
        function openModal() {
            document.getElementById('siteSelectionModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('siteSelectionModal').classList.remove('active');
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                closeModal();
            }
        });

        // Fallback content if JSON fails to load
        function loadFallbackContent() {
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);

            const headlines = [
                "Data Center Construction Booms Across Nation",
                "Northern Virginia Maintains DC Dominance",
                "Hyperscale Investment Reaches Record Highs"
            ];
            document.getElementById('dailyHeadline').textContent = headlines[dayOfYear % headlines.length];

            document.getElementById('article1').innerHTML = `
                <div class="article-headline">Data Center Market Shows Continued Growth</div>
                <div class="article-byline">DC Intel News Desk â€¢ <span class="article-date"></span></div>
                <div class="article-content">Industry analysis indicates sustained expansion in data center construction across major U.S. markets. Cloud computing demand and AI workloads continue driving capacity requirements, with several metropolitan areas seeing record permit activity.</div>
            `;

            document.getElementById('article2').innerHTML = `
                <div class="article-headline">Market Intelligence Platform Updates</div>
                <div class="article-byline">Market Intelligence â€¢ <span class="article-date"></span></div>
                <div class="article-content">DC Intel provides real-time permit tracking and market intelligence across 1,000+ confirmed data center projects nationwide. Our platform offers comprehensive brokerage services, site selection consulting, and custom research capabilities.</div>
            `;

            updateDate();
            populateClassifieds();
        }
        generateDailyContent();

        // Section switching
        function switchSection(section) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.navigation a').forEach(n => n.classList.remove('active'));

            // Map section parameters to actual section IDs
            const sectionMap = {
                'home': 'homeSection',
                'classifieds': 'classifiedsSection',
                'knowledge': 'knowledgeSection',
                'services': 'servicesSection',
                'existing-dcs': 'existingDCsSection',
                'upcoming-dcs': 'upcomingDCsSection'
            };

            const sectionId = sectionMap[section];
            if (!sectionId) {
                console.error(`Unknown section: ${section}`);
                return;
            }

            const sectionElement = document.getElementById(sectionId);
            if (!sectionElement) {
                console.error(`Section element not found: ${sectionId} (from parameter: ${section})`);
                return;
            }
            sectionElement.classList.add('active');

            const navId = 'nav' + section.charAt(0).toUpperCase() + section.slice(1).replace(/-./g, x => x[1].toUpperCase());
            const navEl = document.getElementById(navId);
            if (navEl) navEl.classList.add('active');

            if (section === 'knowledge') loadKnowledge();
            if (section === 'services') loadServices();
            if (section === 'existing-dcs') loadExistingDCs();
            if (section === 'upcoming-dcs') loadUpcomingDCs();

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Tab switching for Existing DCs section
        function showExistingTab(tab) {
            // Hide all tab contents
            document.getElementById('existingTabHeatmapContent').style.display = 'none';
            document.getElementById('existingTabTableContent').style.display = 'none';
            document.getElementById('existingTabContactContent').style.display = 'none';

            // Reset all tab styles
            ['existingTabHeatmap', 'existingTabTable', 'existingTabContact'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.color = '#666';
                    el.style.borderBottom = '3px solid transparent';
                }
            });

            // Show selected tab content and update style
            const contentId = 'existingTab' + tab.charAt(0).toUpperCase() + tab.slice(1) + 'Content';
            const tabId = 'existingTab' + tab.charAt(0).toUpperCase() + tab.slice(1);

            const contentEl = document.getElementById(contentId);
            const tabEl = document.getElementById(tabId);

            if (contentEl) contentEl.style.display = 'block';
            if (tabEl) {
                tabEl.style.color = '#000';
                tabEl.style.borderBottom = '3px solid #000';
            }
        }

        // Tab switching for Upcoming DCs section
        function showUpcomingTab(tab) {
            // Hide all tab contents
            document.getElementById('upcomingTabHeatmapContent').style.display = 'none';
            document.getElementById('upcomingTabTableContent').style.display = 'none';
            document.getElementById('upcomingTabContactContent').style.display = 'none';

            // Reset all tab styles
            ['upcomingTabHeatmap', 'upcomingTabTable', 'upcomingTabContact'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.color = '#666';
                    el.style.borderBottom = '3px solid transparent';
                }
            });

            // Show selected tab content and update style
            const contentId = 'upcomingTab' + tab.charAt(0).toUpperCase() + tab.slice(1) + 'Content';
            const tabId = 'upcomingTab' + tab.charAt(0).toUpperCase() + tab.slice(1);

            const contentEl = document.getElementById(contentId);
            const tabEl = document.getElementById(tabId);

            if (contentEl) contentEl.style.display = 'block';
            if (tabEl) {
                tabEl.style.color = '#000';
                tabEl.style.borderBottom = '3px solid #000';
            }
        }

        // Handle service request form submissions
        function handleServiceRequest(event, serviceType) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData);

            console.log('Service request submitted:', serviceType, data);

            // Show success message
            alert('Thank you! Your request for ' + serviceType + ' has been submitted. We will contact you shortly at ' + data.email + '.');

            // Reset form
            event.target.reset();
        }

        // Knowledge base - load from API
        async function loadKnowledge() {
            try {
                // Try to load from API first
                const response = await fetch(`${API_BASE}/knowledge/glossary`, {
                    headers: { 'X-API-Key': API_KEY }
                });

                let knowledge = [];

                if (response.ok) {
                    const data = await response.json();
                    if (data.items && Array.isArray(data.items)) {
                        knowledge = data.items.map(item => ({
                            term: item.term || item.Term,
                            def: item.definition || item.Definition || item.def
                        }));
                    }
                }

                // Fallback to hardcoded if API fails or returns nothing
                if (knowledge.length === 0) {
                    knowledge = [
                        { term: "Colocation", def: "A data center facility where multiple companies rent space for their servers and equipment. Typically offers shared infrastructure including power, cooling, and connectivity." },
                        { term: "Hyperscale", def: "Massive data centers (typically 100MW+) operated by tech giants like Google, Amazon, Microsoft. Characterized by thousands of servers and enormous power requirements." },
                        { term: "Edge Computing", def: "Distributed computing infrastructure placed closer to end-users for lower latency. Typically smaller facilities in metro areas or near content consumers." },
                        { term: "Power Usage Effectiveness (PUE)", def: "Ratio measuring data center energy efficiency. Calculated as total facility energy divided by IT equipment energy. Lower is better, with 1.0 being ideal." },
                        { term: "Tier Rating", def: "Classification system (I-IV) indicating data center reliability and redundancy levels. Tier IV represents highest availability with fully redundant systems." },
                        { term: "Critical Power", def: "The maximum IT load a data center can support, measured in watts or megawatts. Determines capacity available for servers and networking equipment." },
                        { term: "Uptime", def: "Percentage of time a data center remains operational. Tier IV targets 99.995% uptime, allowing only 26 minutes downtime per year." },
                        { term: "Hot Aisle/Cold Aisle", def: "Server layout design optimizing cooling efficiency by separating hot exhaust air from cold intake air, reducing energy consumption." },
                        { term: "Cross-Connect", def: "Physical cable connecting different customer equipment within a colocation facility, enabling direct private connectivity between parties." }
                    ];
                }

                document.getElementById('knowledgeGrid').innerHTML = knowledge.map(k => `
                    <div class="knowledge-card">
                        <h4>${k.term}</h4>
                        <p>${k.def}</p>
                    </div>
                `).join('');

                // Search functionality
                document.getElementById('knowledgeSearch').addEventListener('input', function() {
                    const search = this.value.toLowerCase();
                    document.querySelectorAll('.knowledge-card').forEach(card => {
                        const text = card.textContent.toLowerCase();
                        card.style.display = text.includes(search) ? 'block' : 'none';
                    });
                });

            } catch (error) {
                console.error('Error loading knowledge:', error);
                // Use fallback data
                loadKnowledge();
            }
        }

        // Switch knowledge tab
        function switchKnowledgeTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.knowledge-tab').forEach(btn => btn.classList.remove('active-tab'));
            document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active-tab');

            // Show/hide views
            document.getElementById('glossaryView').style.display = tab === 'glossary' ? 'block' : 'none';
            document.getElementById('handbookView').style.display = tab === 'handbook' ? 'block' : 'none';
            document.getElementById('taxonomyView').style.display = tab === 'taxonomy' ? 'block' : 'none';

            // Load content if needed
            if (tab === 'handbook' && !window.handbookLoaded) {
                loadHandbook();
            } else if (tab === 'taxonomy' && !window.taxonomyLoaded) {
                loadTaxonomy();
            }
        }

        // Load handbook
        async function loadHandbook() {
            try {
                const response = await fetch(`${API_BASE}/knowledge/handbook`, {
                    headers: { 'X-API-Key': API_KEY }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.ok && data.preview) {
                        // Convert markdown to HTML-like display
                        let content = data.preview
                            .replace(/^# (.+)$/gm, '<h2 style="text-align: center; font-size: 24px; margin: 20px 0; text-transform: uppercase; letter-spacing: 2px; border-bottom: 3px double #000; padding-bottom: 10px;">$1</h2>')
                            .replace(/^## (.+)$/gm, '<h3 style="font-size: 18px; margin: 18px 0 10px 0; font-weight: bold; border-bottom: 2px solid #000; padding-bottom: 5px;">$1</h3>')
                            .replace(/^### (.+)$/gm, '<h4 style="font-size: 16px; margin: 15px 0 8px 0; font-weight: bold;">$1</h4>')
                            .replace(/^\*\*(.+?)\*\*/gm, '<strong>$1</strong>')
                            .replace(/^- (.+)$/gm, '<li style="margin: 5px 0;">$1</li>')
                            .replace(/\n\n/g, '<p style="margin: 12px 0;"></p>')
                            .replace(/\n/g, '<br>');

                        document.getElementById('handbookContent').innerHTML = content;
                        window.handbookLoaded = true;
                    }
                }
            } catch (error) {
                console.error('Error loading handbook:', error);
                document.getElementById('handbookContent').innerHTML = '<p style="text-align: center; color: #c00;">Failed to load handbook content.</p>';
            }
        }

        // Load taxonomy
        async function loadTaxonomy() {
            try {
                const response = await fetch(`${API_BASE}/knowledge/taxonomy`, {
                    headers: { 'X-API-Key': API_KEY }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.sheets && Array.isArray(data.sheets)) {
                        const taxonomyHTML = data.sheets.map((sheetName, idx) => `
                            <div class="taxonomy-card" style="transform: rotate(${idx % 2 === 0 ? '-' : ''}0.5deg);">
                                <h3>${sheetName.replace(/_/g, ' ')}</h3>
                                <p style="text-align: center; font-style: italic; color: #666; margin-top: 20px;">
                                    Click to explore ${sheetName.replace(/_/g, ' ')} classifications
                                </p>
                            </div>
                        `).join('');

                        document.getElementById('taxonomyContent').innerHTML = taxonomyHTML;
                        window.taxonomyLoaded = true;
                    }
                }
            } catch (error) {
                console.error('Error loading taxonomy:', error);
                document.getElementById('taxonomyContent').innerHTML = '<p style="text-align: center; color: #c00; grid-column: 1 / -1;">Failed to load taxonomy content.</p>';
            }
        }

        // Services - All 17 services
        function loadServices() {
            const services = [
                { id: "brokerage", name: "Data Center Brokerage", desc: "Expert representation for buying, selling, or leasing data center facilities and capacity. Our team leverages extensive market knowledge and relationships to secure optimal terms for clients. We handle facility acquisitions, wholesale capacity transactions, and strategic advisory." },
                { id: "intelligence", name: "Market Intelligence Platform", desc: "Real-time access to our comprehensive database of permits and over 1,000 confirmed data center projects across the United States. Includes permit tracking, valuation data, trend analysis, operator monitoring, and competitive intelligence. Don't see your city? Request coverage - we can add new markets to serve your needs." },
                { id: "siteselection", name: "Site Selection Consulting", desc: "Comprehensive analysis of potential DC locations considering power availability, fiber connectivity, tax incentives, risk factors, and market dynamics. We identify optimal sites aligned with your technical and financial requirements." },
                { id: "duediligence", name: "Due Diligence Services", desc: "Technical and financial assessment of DC assets including infrastructure review, lease analysis, operational benchmarking, and risk evaluation. Supports informed decision-making for acquisitions and investments." },
                { id: "reports", name: "Custom Market Reports", desc: "Tailored research deliverables covering specific markets, operators, or project types. Available in weekly, monthly, or ad-hoc formats. Includes executive summaries, detailed analytics, and actionable recommendations." },
                { id: "advisory", name: "Strategic Advisory", desc: "High-level guidance on DC strategy, capacity planning, market entry, portfolio optimization, and investment decisions. Our advisors bring decades of combined industry experience." },
                { name: "DC Matchmaking Service", desc: "Connect buyers and sellers in the data center market. We match your specific requirements with available facilities, capacity, or development opportunities. Comprehensive screening, qualification, and negotiation support.", link: "showDCMatchmaking" },
                { name: "Lead Referral Program", desc: "Earn commissions by referring qualified data center opportunities. We handle the full transaction process while you earn industry-leading referral fees. Perfect for consultants, brokers, and industry professionals.", link: "showLeadReferral" },
                { name: "Premium Data Access", desc: "Advanced access to our full database with custom filtering, export capabilities, and API integration. Includes detailed project timelines, contractor information, and historical trend analysis.", link: "showPremiumData" },
                { name: "API Integration", desc: "Integrate DC Intel data directly into your systems via our RESTful API. Real-time permit updates, search capabilities, and webhook notifications. Multiple tier options available.", link: "showAPIAccess" },
                { name: "RFQ Management", desc: "Streamlined request for quotation process for data center capacity. Submit requirements once and receive competitive proposals from multiple providers. We manage the entire RFQ lifecycle.", link: "showRFQManagement" },
                { name: "Email Alerts & Notifications", desc: "Receive instant notifications when new projects match your criteria. Configure custom alerts for specific markets, operators, project sizes, or other parameters.", link: "showEmailAlerts" },
                { name: "Request Coverage Expansion", desc: "Don't see your city or region? Request us to add coverage for new markets. We prioritize expansion based on customer demand and can add new jurisdictions within 30-60 days.", link: "showRequestCoverage" },
                { name: "Construction Timeline Predictions", desc: "AI-powered forecasting of project timelines based on historical permit data, contractor schedules, and market conditions. Predict when facilities will come online." },
                { name: "DC Comparison Tool", desc: "Side-by-side comparison of multiple data center projects including specifications, locations, costs, and timelines. Export detailed comparison reports." },
                { name: "Demand Heatmap Analytics", desc: "Visual analysis of data center demand and supply by geography. Identify underserved markets, saturation zones, and emerging opportunities." },
                { name: "Sponsored Listings", desc: "Promote your data center project, available capacity, or services to our audience of industry professionals, investors, and enterprise buyers." }
            ];

            document.getElementById('servicesList').innerHTML = services.map(s => `
                <div class="service-item">
                    <h3>
                        ${s.id ? `<a href="#" onclick="showServiceModal('${s.id}'); return false;" style="color: #000; text-decoration: none;">${s.name}</a>` : s.name}
                        ${s.link && !s.id ? ' <a href="#" onclick="' + s.link + '(); return false;" style="font-size: 12px; color: #000; text-decoration: underline;">[Request Service]</a>' : ''}
                    </h3>
                    <p>${s.desc}</p>
                </div>
            `).join('');
        }

        // Show service-specific modal
        function showServiceModal(serviceId) {
            document.getElementById('serviceModal_' + serviceId).style.display = 'flex';
        }

        // Close service modal
        function closeServiceModal(serviceId) {
            document.getElementById('serviceModal_' + serviceId).style.display = 'none';
        }

        // Handle service inquiry form submission
        function handleServiceInquiry(event, serviceType) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData);

            console.log('Service inquiry submitted:', serviceType, data);
            alert('Thank you for your interest in ' + serviceType + '! We will contact you shortly at ' + data.email + '.');

            // Close modal and reset form
            const modalId = event.target.closest('.modal-overlay').id.replace('serviceModal_', '');
            closeServiceModal(modalId);
            event.target.reset();
        }

        // Existing DCs with heatmap visualization
        async function loadExistingDCs() {
            try {
                // Fetch all data with pagination (max 1000 per request)
                let allItems = [];
                let offset = 0;
                const limit = 1000;
                let hasMore = true;

                while (hasMore) {
                    const response = await fetch(`${API_BASE}/datacenters/existing?limit=${limit}&offset=${offset}`, {
                        headers: { 'X-API-Key': API_KEY }
                    });
                    const data = await response.json();

                    if (!data.items || data.items.length === 0) {
                        break;
                    }

                    allItems = allItems.concat(data.items);
                    offset += limit;

                    // Check if there are more items to fetch
                    hasMore = data.total > offset;
                }

                if (allItems.length === 0) {
                    document.getElementById('existingDCsTableView').innerHTML = '<p style="text-align: center;">Unable to load data centers. Please ensure API server is running.</p>';
                    return;
                }

                // Use allItems instead of data.items
                const data = { items: allItems, total: allItems.length };

                // Generate heatmap by state - Initialize ALL 50 states (using abbreviations)
                const allUSStates = [
                    'AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA',
                    'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD',
                    'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ',
                    'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC',
                    'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'DC'
                ];

                const stateData = {};
                // Initialize all states with 0 count
                allUSStates.forEach(state => {
                    stateData[state] = { count: 0 };
                });

                // Add actual data
                data.items.forEach(item => {
                    let state = item.state_guess || item.State || 'Unknown';
                    // Ensure state is uppercase 2-letter abbreviation
                    state = state.toUpperCase().trim();

                    if (!stateData[state]) {
                        stateData[state] = { count: 0 };
                    }
                    stateData[state].count++;
                });

                // Sort states by DC count (show all 50)
                const sortedStates = Object.entries(stateData)
                    .sort((a, b) => b[1].count - a[1].count);

                // Determine heat levels
                const maxCount = Math.max(...sortedStates.map(s => s[1].count));

                let heatmapHTML = '<h3 style="text-align: center; margin-bottom: 15px;">Existing Data Centers by State (All 50 States)</h3>';
                heatmapHTML += '<div class="heatmap-container">';

                sortedStates.forEach(([state, stats]) => {
                    // Handle zero counts - show very light color
                    const intensity = maxCount > 0 ? stats.count / maxCount : 0;
                    let heatClass = 'heat-low';
                    if (stats.count === 0) {
                        heatClass = 'heat-low'; // Very light gray for no data
                    } else if (intensity > 0.75) {
                        heatClass = 'heat-extreme';
                    } else if (intensity > 0.5) {
                        heatClass = 'heat-high';
                    } else if (intensity > 0.25) {
                        heatClass = 'heat-medium';
                    }

                    heatmapHTML += `
                        <div class="heatmap-cell ${heatClass}" style="${stats.count === 0 ? 'opacity: 0.4;' : ''}">
                            <div class="heatmap-label">${state}</div>
                            <div class="heatmap-value">${stats.count}</div>
                            <div style="font-size: 9px;">${stats.count === 0 ? 'no data' : 'data centers'}</div>
                        </div>
                    `;
                });
                heatmapHTML += '</div>';
                document.getElementById('heatmapViz').innerHTML = heatmapHTML;

                // Generate table
                let html = `<h3 style="text-align: center; margin-bottom: 15px;">Operational Data Centers (${data.total} total)</h3>`;
                html += '<table style="width: 100%; border-collapse: collapse; font-size: 12px;">';
                html += '<tr style="background: #000; color: #fff;"><th style="padding: 8px; text-align: left;">Provider</th><th style="padding: 8px; text-align: left;">Title</th><th style="padding: 8px; text-align: left;">City</th><th style="padding: 8px; text-align: left;">State</th><th style="padding: 8px; text-align: left;">Address</th></tr>';

                data.items.forEach((item, idx) => {
                    const bg = idx % 2 === 0 ? '#fff' : '#f9f9f9';
                    const provider = item.provider || 'Unknown';
                    const title = item.title || 'N/A';
                    const city = item.city_guess || 'N/A';
                    const state = item.state_guess || 'N/A';
                    const address = item.street_full_guess || item.address_line_raw || 'N/A';

                    html += `<tr style="background: ${bg}; border-bottom: 1px solid #ccc;">
                        <td style="padding: 8px;">${provider}</td>
                        <td style="padding: 8px;">${title}</td>
                        <td style="padding: 8px;">${city}</td>
                        <td style="padding: 8px;">${state}</td>
                        <td style="padding: 8px;">${address}</td>
                    </tr>`;
                });

                html += '</table>';

                // Populate the table view tab
                document.getElementById('existingDCsTableView').innerHTML = html;

            } catch (error) {
                console.error('Error loading DCs:', error);
                const errorMsg = '<p style="text-align: center;">Error loading data. Please check API connection.</p>';
                document.getElementById('existingDCsTableView').innerHTML = errorMsg;
            }
        }

        // Load Upcoming DCs
        // Simple CSV parser function
        function parseCSV(text) {
            const lines = text.split('\n').filter(line => line.trim());
            const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
            const rows = [];

            for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;

                for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim().replace(/^"|"$/g, ''));
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim().replace(/^"|"$/g, ''));

                if (values.length === headers.length) {
                    const row = {};
                    headers.forEach((header, idx) => {
                        row[header] = values[idx];
                    });
                    rows.push(row);
                }
            }
            return rows;
        }

        async function loadUpcomingDCs() {
            try {
                // Load CSV file with cache-busting
                const timestamp = new Date().getTime();
                const response = await fetch(`/masters/DC_Upcoming_Combined.csv?t=${timestamp}`);

                if (!response.ok) {
                    document.getElementById('upcomingDCsTable').innerHTML = '<p style="text-align: center;">Unable to load upcoming DC projects. CSV file may not be available.</p>';
                    return;
                }

                const csvText = await response.text();
                let projects = parseCSV(csvText);

                // Filter out TBD,TBD entries (news articles without verified locations)
                projects = projects.filter(p => {
                    const city = (p.city || '').toUpperCase().trim();
                    const state = (p.state || '').toUpperCase().trim();
                    // Remove if both city AND state are TBD
                    return !(city === 'TBD' && state === 'TBD');
                });

                if (!projects || projects.length === 0) {
                    document.getElementById('upcomingDCsTable').innerHTML = '<p style="text-align: center;">No upcoming DC projects found.</p>';
                    return;
                }

                console.log(`Loaded ${projects.length} upcoming DC projects (TBD,TBD entries filtered)`);

                // Generate regional heatmap with color coding by source - ALL 50 STATES (using abbreviations)
                const allUSStates = [
                    'AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA',
                    'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD',
                    'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ',
                    'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC',
                    'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'DC'
                ];

                const regionData = {};
                const regionSourceCounts = {}; // Track news vs permit by region

                // Initialize all 50 states
                allUSStates.forEach(state => {
                    regionData[state] = 0;
                    regionSourceCounts[state] = { news: 0, permit: 0 };
                });

                projects.forEach(project => {
                    let region = project.state || 'Unknown';
                    const source = project.source || 'unknown';

                    // Ensure region is uppercase 2-letter abbreviation
                    region = region.toUpperCase().trim();

                    if (!regionData[region]) {
                        regionData[region] = 0;
                        regionSourceCounts[region] = { news: 0, permit: 0 };
                    }
                    regionData[region]++;

                    if (source === 'news') {
                        regionSourceCounts[region].news++;
                    } else if (source === 'permit') {
                        regionSourceCounts[region].permit++;
                    }
                });

                const sortedRegions = Object.entries(regionData)
                    .sort((a, b) => b[1] - a[1]);

                const maxCount = Math.max(...sortedRegions.map(r => r[1]));

                let heatmapHTML = '<h3 style="text-align: center; margin-bottom: 15px;">Upcoming DC Projects by State (All 50 States)</h3>';
                heatmapHTML += '<div class="heatmap-container">';
                sortedRegions.forEach(([region, count]) => {
                    // Handle zero counts - show very light color
                    const intensity = maxCount > 0 ? count / maxCount : 0;
                    let heatClass = 'heat-low';
                    if (count === 0) {
                        heatClass = 'heat-low'; // Very light gray for no data
                    } else if (intensity > 0.75) {
                        heatClass = 'heat-extreme';
                    } else if (intensity > 0.5) {
                        heatClass = 'heat-high';
                    } else if (intensity > 0.25) {
                        heatClass = 'heat-medium';
                    }

                    const newsCount = regionSourceCounts[region].news;
                    const permitCount = regionSourceCounts[region].permit;

                    heatmapHTML += `
                        <div class="heatmap-cell ${heatClass}" style="${count === 0 ? 'opacity: 0.4;' : ''}">
                            <div class="heatmap-label">${region}</div>
                            <div class="heatmap-value">${count}</div>
                            <div style="font-size: 9px;">${count === 0 ? 'no data' : 'projects'}</div>
                            ${count > 0 ? `
                            <div style="font-size: 8px; margin-top: 4px; color: #666;">
                                <span style="color: #ffc107;">âš¡${newsCount}</span> /
                                <span style="color: #198754;">ðŸ“${permitCount}</span>
                            </div>
                            ` : ''}
                        </div>
                    `;
                });
                heatmapHTML += '</div>';
                document.getElementById('upcomingHeatmap').innerHTML = heatmapHTML;

                // Sort projects: those with addresses/links first, then by date
                projects.sort((a, b) => {
                    // Check if item has either an address (permits) or source URL (news)
                    const aHasInfo = (a.address_raw && a.address_raw !== 'TBD' && a.address_raw.trim() !== '') ||
                                     (a.source === 'news' && a.source_url);
                    const bHasInfo = (b.address_raw && b.address_raw !== 'TBD' && b.address_raw.trim() !== '') ||
                                     (b.source === 'news' && b.source_url);

                    if (aHasInfo && !bHasInfo) return -1;
                    if (!aHasInfo && bHasInfo) return 1;

                    // If both have same info status, sort by first seen date (newest first)
                    return (b.first_seen_applied_date || '').localeCompare(a.first_seen_applied_date || '');
                });

                // Generate project table with color coding
                let tableHTML = '<table style="width: 100%; border-collapse: collapse; font-size: 12px;">';
                tableHTML += '<tr style="background: #000; color: #fff;">';
                tableHTML += '<th style="padding: 8px; text-align: left;">Location</th>';
                tableHTML += '<th style="padding: 8px; text-align: left;">Address</th>';
                tableHTML += '<th style="padding: 8px; text-align: left;">Status</th>';
                tableHTML += '<th style="padding: 8px; text-align: left;">First Seen</th>';
                tableHTML += '<th style="padding: 8px; text-align: left;">Source</th>';
                tableHTML += '<th style="padding: 8px; text-align: center;">Covered</th>';
                tableHTML += '</tr>';

                projects.forEach((project, idx) => {
                    const isNews = project.source === 'news';

                    // Color coding: Yellow for news, Green for permits
                    const bgBase = isNews ? '#fff3cd' : '#d1e7dd';
                    const borderColor = isNews ? '#ffc107' : '#198754';
                    const icon = isNews ? 'âš¡' : 'ðŸ“';

                    const city = project.city || 'TBD';
                    const state = project.state || 'TBD';
                    const location = `${icon} ${city}, ${state}`;

                    // Address column: show link for news, address for permits
                    let addressDisplay;
                    if (isNews && project.source_url) {
                        // For news: show clickable link
                        addressDisplay = `<a href="${project.source_url}" target="_blank" style="color: #0066cc; text-decoration: underline;">View Article â†’</a>`;
                    } else if (project.address_raw && project.address_raw !== 'TBD') {
                        // For permits: show actual address
                        addressDisplay = project.address_raw;
                    } else {
                        addressDisplay = '-';
                    }

                    const status = project.latest_status || 'Unknown';
                    const firstSeen = project.first_seen_applied_date || '-';
                    const sourceLabel = isNews ? 'News' : 'Permit';
                    const isCovered = project.covered === 'True' || project.covered === true;

                    tableHTML += `<tr style="background: ${bgBase}; border-left: 4px solid ${borderColor}; border-bottom: 1px solid #ccc;">
                        <td style="padding: 8px;">${location}</td>
                        <td style="padding: 8px;">${addressDisplay}</td>
                        <td style="padding: 8px;">${status}</td>
                        <td style="padding: 8px;">${firstSeen}</td>
                        <td style="padding: 8px;">
                            <span style="background: ${isNews ? '#ffc107' : '#198754'}; color: ${isNews ? '#000' : '#fff'}; padding: 2px 8px; border-radius: 3px; font-size: 11px; font-weight: bold;">
                                ${sourceLabel}
                            </span>
                        </td>
                        <td style="padding: 8px; text-align: center;">
                            ${isCovered ? '<span style="color: #198754; font-weight: bold;">âœ“</span>' : '<span style="color: #999;">âœ—</span>'}
                        </td>
                    </tr>`;
                });

                tableHTML += '</table>';

                // Add summary
                const newsCount = projects.filter(p => p.source === 'news').length;
                const permitCount = projects.filter(p => p.source === 'permit').length;

                const summaryHTML = `
                    <div style="margin-top: 10px; padding: 10px; background: #f0f0f0; border: 2px solid #000; font-size: 12px;">
                        <strong>Total Projects: ${projects.length}</strong>
                        (<span style="color: #ffc107; font-weight: bold;">âš¡ ${newsCount} News Discoveries</span> +
                        <span style="color: #198754; font-weight: bold;">ðŸ“ ${permitCount} Permitted</span>)
                    </div>
                `;

                document.getElementById('upcomingDCsTable').innerHTML = summaryHTML + tableHTML;

            } catch (error) {
                console.error('Error loading upcoming DCs:', error);
                document.getElementById('upcomingDCsTable').innerHTML = '<p style="text-align: center;">Error loading data. Please check CSV file location.</p>';
            }
        }

        // Search functions
        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        async function doSearch(query) {
            if (!query) query = document.getElementById('searchInput').value.trim();
            if (!query) {
                alert('Please enter a search query');
                return;
            }

            // Make sure we're on home section
            switchSection('home');

            document.getElementById('searchInput').value = query;
            showLoading();

            try {
                const response = await fetch(`${API_BASE}/ask_v2`, {
                    method: 'POST',
                    headers: {
                        'X-API-Key': API_KEY,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ q: query })
                });

                const data = await response.json();
                hideLoading();

                if (!data.ok) {
                    alert('Search failed. Please try again.');
                    return;
                }

                displayResults(data, query);

            } catch (error) {
                hideLoading();
                alert('API Error: ' + error.message + '\n\nMake sure server is running on http://127.0.0.1:8010');
                document.getElementById('apiStatus').textContent = 'OFFLINE';
                document.getElementById('apiStatus').style.color = 'red';
            }
        }

        function displayResults(data, query) {
            const contentArea = document.getElementById('contentArea');
            let html = `<div class="headline-main">Search Results: "${query}"</div>`;

            // Service inquiry response
            if (data.intent === 'SERVICE_INQUIRY' && data.response) {
                html += `
                    <div class="article">
                        <div class="article-headline">DC Intel Services</div>
                        <div class="article-byline">Intelligence Desk</div>
                        <div class="article-content">${data.response}</div>
                    </div>
                `;
            }

            // Rollup/facility results
            if (data.rollups && data.rollups.total > 0) {
                const items = data.rollups.items.slice(0, 12);
                items.forEach((item, idx) => {
                    // Handle both field naming conventions
                    const address = item.address_raw || item.Address || 'Unknown Location';
                    const city = item.city || item.City || 'N/A';
                    const state = item.state || item.State || 'N/A';
                    const description = item.latest_description || item.Description || 'No description available';
                    const valuation = item.latest_valuation_usd || item.TotalValuation || 0;
                    const permitCount = item.permits_count || item.PermitCount || 0;
                    const latestDate = item.last_seen_applied_date || item.LatestDate || 'N/A';

                    html += `
                        <div class="article">
                            <div class="article-headline">${idx + 1}. ${address}</div>
                            <div class="article-byline">${city}, ${state} â€¢ Valuation: $${valuation.toLocaleString()}</div>
                            <div class="article-content">
                                ${description.substring(0, 200)}...
                                <br><strong>Permits:</strong> ${permitCount} |
                                <strong>Latest:</strong> ${latestDate}
                            </div>
                        </div>
                    `;
                });
            }

            // News results
            if (data.news && data.news.total > 0) {
                const newsItems = data.news.items.slice(0, 6);
                newsItems.forEach((item) => {
                    html += `
                        <div class="article">
                            <div class="article-headline">${item.Title || item.Headline || 'News Article'}</div>
                            <div class="article-byline">Published: ${item.PublishedDate || item.Date || 'Unknown'}</div>
                            <div class="article-content">
                                ${item.Summary || item.Snippet || 'No summary available.'}
                            </div>
                        </div>
                    `;
                });
            }

            // No results
            if ((!data.rollups || data.rollups.total === 0) &&
                (!data.news || data.news.total === 0) &&
                data.intent !== 'SERVICE_INQUIRY') {
                html += `
                    <div class="article">
                        <div class="article-headline">No Results Found</div>
                        <div class="article-content">
                            No matching facilities or news articles found for your query.
                            Try refining your search terms or use one of the quick query links above.
                        </div>
                    </div>
                `;
            }

            contentArea.innerHTML = html;
            contentArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Search event listeners
        document.getElementById('searchBtn').addEventListener('click', () => doSearch());
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') doSearch();
        });

        // Service request functions
        function showServiceModal(serviceName) {
            document.getElementById('serviceModalTitle').textContent = serviceName;
            document.getElementById('serviceModal').classList.add('active');
            document.getElementById('serviceForm').reset();
        }

        function showPremiumData() {
            showServiceModal('Premium Data Access Request');
        }

        function showDCMatchmaking() {
            showServiceModal('DC Matchmaking Service Request');
        }

        function showLeadReferral() {
            showServiceModal('Lead Referral Program Enrollment');
        }

        function showAPIAccess() {
            showServiceModal('API Integration Request');
        }

        function showRFQManagement() {
            showServiceModal('RFQ Management Request');
        }

        function showEmailAlerts() {
            showServiceModal('Email Alerts Configuration');
        }

        function showRequestCoverage() {
            showServiceModal('Request Coverage Expansion');
        }

        async function handleServiceRequest(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const serviceName = document.getElementById('serviceModalTitle').textContent;

            const requestData = {
                service: serviceName,
                name: formData.get('name'),
                email: formData.get('email'),
                company: formData.get('company'),
                phone: formData.get('phone'),
                details: formData.get('details')
            };

            try {
                const response = await fetch(`${API_BASE}/api/service_request`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': API_KEY
                    },
                    body: JSON.stringify(requestData)
                });

                const data = await response.json();

                if (data.ok || response.ok) {
                    alert('Thank you! Your service request has been submitted. We will contact you within 24 hours.');
                    closeModal('serviceModal');
                } else {
                    alert('Request submitted locally. Our team will review and respond soon.');
                    closeModal('serviceModal');
                }
            } catch (error) {
                console.error('Service request error:', error);
                alert('Request submitted. We will contact you at the email address provided.');
                closeModal('serviceModal');
            }
        }

        // Check API status on load
        fetch(`${API_BASE}/rollups/addresses?limit=1`, {
            headers: { 'X-API-Key': API_KEY }
        })
        .then(res => {
            if (res.ok) {
                document.getElementById('apiStatus').textContent = 'ONLINE';
                document.getElementById('apiStatus').style.color = 'green';
            }
        })
        .catch(() => {
            document.getElementById('apiStatus').textContent = 'OFFLINE';
            document.getElementById('apiStatus').style.color = 'red';
        });
    </script>

    <!-- SERVICE MODALS -->
    <!-- Data Center Brokerage Modal -->
    <div class="modal-overlay" id="serviceModal_brokerage" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('brokerage')">&times;</span>
            <div class="modal-header">Data Center Brokerage</div>
            <form onsubmit="handleServiceInquiry(event, 'Data Center Brokerage')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Transaction Type *</label>
                    <select name="transaction_type" required>
                        <option value="">Select...</option>
                        <option value="buy">Buying DC Facility</option>
                        <option value="sell">Selling DC Facility</option>
                        <option value="lease">Leasing DC Space/Capacity</option>
                        <option value="advisory">Strategic Advisory</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Power Requirements (if applicable)</label>
                    <input type="text" name="power" placeholder="e.g., 10MW, 50MW">
                </div>
                <div class="form-group">
                    <label>Target Markets/Regions *</label>
                    <textarea name="markets" rows="2" required placeholder="e.g., Northern Virginia, Dallas, Silicon Valley"></textarea>
                </div>
                <div class="form-group">
                    <label>Timeline *</label>
                    <select name="timeline" required>
                        <option value="">Select...</option>
                        <option value="immediate">Immediate (0-3 months)</option>
                        <option value="short">Short-term (3-6 months)</option>
                        <option value="medium">Medium-term (6-12 months)</option>
                        <option value="long">Long-term (12+ months)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Additional Details</label>
                    <textarea name="details" rows="4" placeholder="Tell us about your specific requirements, budget range, technical needs, etc."></textarea>
                </div>
                <button type="submit" class="form-submit">Submit Inquiry</button>
            </form>
        </div>
    </div>

    <!-- Market Intelligence Platform Modal -->
    <div class="modal-overlay" id="serviceModal_intelligence" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('intelligence')">&times;</span>
            <div class="modal-header">Market Intelligence Platform</div>
            <form onsubmit="handleServiceInquiry(event, 'Market Intelligence Platform')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Primary Use Case *</label>
                    <select name="use_case" required>
                        <option value="">Select...</option>
                        <option value="competitive">Competitive Intelligence</option>
                        <option value="market">Market Research</option>
                        <option value="development">Development Tracking</option>
                        <option value="investment">Investment Analysis</option>
                        <option value="sales">Sales Prospecting</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Markets of Interest *</label>
                    <textarea name="markets" rows="3" required placeholder="List all cities/regions you're interested in tracking"></textarea>
                </div>
                <div class="form-group">
                    <label>Specific Operators to Track</label>
                    <input type="text" name="operators" placeholder="e.g., Digital Realty, Equinix, QTS">
                </div>
                <div class="form-group">
                    <label>Data Export Needs</label>
                    <select name="export_needs">
                        <option value="">Select...</option>
                        <option value="csv">CSV Export</option>
                        <option value="excel">Excel with Analytics</option>
                        <option value="api">API Integration</option>
                        <option value="all">All of the above</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Team Size</label>
                    <input type="number" name="team_size" placeholder="Number of users needed">
                </div>
                <div class="form-group">
                    <label>Additional Requirements</label>
                    <textarea name="requirements" rows="3" placeholder="Any specific data points, features, or integrations needed?"></textarea>
                </div>
                <button type="submit" class="form-submit">Request Demo</button>
            </form>
        </div>
    </div>

    <!-- Site Selection Consulting Modal -->
    <div class="modal-overlay" id="serviceModal_siteselection" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('siteselection')">&times;</span>
            <div class="modal-header">Site Selection Consulting</div>
            <form onsubmit="handleServiceInquiry(event, 'Site Selection Consulting')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Project Type *</label>
                    <select name="project_type" required>
                        <option value="">Select...</option>
                        <option value="hyperscale">Hyperscale (100MW+)</option>
                        <option value="enterprise">Enterprise (10-100MW)</option>
                        <option value="edge">Edge/Small (1-10MW)</option>
                        <option value="colocation">Colocation Expansion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Power Requirements *</label>
                    <input type="text" name="power" required placeholder="e.g., 20MW, 100MW">
                </div>
                <div class="form-group">
                    <label>Geographic Preferences *</label>
                    <textarea name="geography" rows="2" required placeholder="Preferred regions, states, or metro areas"></textarea>
                </div>
                <div class="form-group">
                    <label>Key Requirements</label>
                    <textarea name="requirements" rows="4" placeholder="Power availability, fiber connectivity, tax incentives, proximity to customers, etc."></textarea>
                </div>
                <div class="form-group">
                    <label>Project Timeline *</label>
                    <select name="timeline" required>
                        <option value="">Select...</option>
                        <option value="planning">Planning Phase</option>
                        <option value="6months">Within 6 months</option>
                        <option value="12months">Within 12 months</option>
                        <option value="18months">12-18 months</option>
                        <option value="later">18+ months</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Budget Range (Optional)</label>
                    <input type="text" name="budget" placeholder="Total project budget estimate">
                </div>
                <button type="submit" class="form-submit">Request Consultation</button>
            </form>
        </div>
    </div>

    <!-- Due Diligence Services Modal -->
    <div class="modal-overlay" id="serviceModal_duediligence" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('duediligence')">&times;</span>
            <div class="modal-header">Due Diligence Services</div>
            <form onsubmit="handleServiceInquiry(event, 'Due Diligence Services')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Transaction Type *</label>
                    <select name="transaction_type" required>
                        <option value="">Select...</option>
                        <option value="acquisition">Facility Acquisition</option>
                        <option value="investment">Investment/Funding</option>
                        <option value="lease">Major Lease Agreement</option>
                        <option value="portfolio">Portfolio Review</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Facility Location(s) *</label>
                    <textarea name="locations" rows="2" required placeholder="City, State for facility/facilities under review"></textarea>
                </div>
                <div class="form-group">
                    <label>Facility Size/Capacity</label>
                    <input type="text" name="size" placeholder="e.g., 50MW, 200,000 sq ft">
                </div>
                <div class="form-group">
                    <label>Due Diligence Scope *</label>
                    <textarea name="scope" rows="4" required placeholder="Technical assessment, financial review, operational audit, lease analysis, market positioning, etc."></textarea>
                </div>
                <div class="form-group">
                    <label>Timeline/Deadline *</label>
                    <select name="timeline" required>
                        <option value="">Select...</option>
                        <option value="urgent">Urgent (1-2 weeks)</option>
                        <option value="standard">Standard (3-4 weeks)</option>
                        <option value="comprehensive">Comprehensive (6-8 weeks)</option>
                        <option value="flexible">Flexible</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Additional Information</label>
                    <textarea name="additional" rows="3" placeholder="Any specific concerns, red flags to investigate, or areas of focus?"></textarea>
                </div>
                <button type="submit" class="form-submit">Request Quote</button>
            </form>
        </div>
    </div>

    <!-- Custom Market Reports Modal -->
    <div class="modal-overlay" id="serviceModal_reports" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('reports')">&times;</span>
            <div class="modal-header">Custom Market Reports</div>
            <form onsubmit="handleServiceInquiry(event, 'Custom Market Reports')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Report Focus *</label>
                    <select name="report_focus" required>
                        <option value="">Select...</option>
                        <option value="market">Specific Market Analysis</option>
                        <option value="operator">Operator Activity Report</option>
                        <option value="supply_demand">Supply/Demand Analysis</option>
                        <option value="trends">Industry Trends</option>
                        <option value="competitive">Competitive Landscape</option>
                        <option value="forecast">Market Forecast</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Geographic Scope *</label>
                    <textarea name="geography" rows="2" required placeholder="Markets, regions, or operators to cover"></textarea>
                </div>
                <div class="form-group">
                    <label>Report Frequency *</label>
                    <select name="frequency" required>
                        <option value="">Select...</option>
                        <option value="one-time">One-Time Report</option>
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="annual">Annual</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Key Questions to Answer *</label>
                    <textarea name="key_questions" rows="4" required placeholder="What specific questions should this report answer?"></textarea>
                </div>
                <div class="form-group">
                    <label>Delivery Format</label>
                    <select name="format">
                        <option value="pdf">PDF Report</option>
                        <option value="excel">Excel with Data</option>
                        <option value="powerpoint">PowerPoint Deck</option>
                        <option value="all">All Formats</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Timeline</label>
                    <input type="text" name="timeline" placeholder="When do you need the first report?">
                </div>
                <button type="submit" class="form-submit">Request Proposal</button>
            </form>
        </div>
    </div>

    <!-- Strategic Advisory Modal -->
    <div class="modal-overlay" id="serviceModal_advisory" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeServiceModal('advisory')">&times;</span>
            <div class="modal-header">Strategic Advisory</div>
            <form onsubmit="handleServiceInquiry(event, 'Strategic Advisory')">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Company *</label>
                    <input type="text" name="company" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" name="phone">
                </div>
                <div class="form-group">
                    <label>Your Role *</label>
                    <input type="text" name="role" required placeholder="e.g., CTO, VP Infrastructure, CEO">
                </div>
                <div class="form-group">
                    <label>Advisory Need *</label>
                    <select name="advisory_type" required>
                        <option value="">Select...</option>
                        <option value="strategy">DC Strategy Development</option>
                        <option value="capacity">Capacity Planning</option>
                        <option value="market_entry">Market Entry Strategy</option>
                        <option value="portfolio">Portfolio Optimization</option>
                        <option value="investment">Investment Decision Support</option>
                        <option value="buildvsbuy">Build vs Buy Analysis</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Current Situation *</label>
                    <textarea name="situation" rows="4" required placeholder="Describe your current DC footprint, challenges, and strategic objectives"></textarea>
                </div>
                <div class="form-group">
                    <label>Key Challenges *</label>
                    <textarea name="challenges" rows="3" required placeholder="What are the main challenges you're facing?"></textarea>
                </div>
                <div class="form-group">
                    <label>Desired Outcomes</label>
                    <textarea name="outcomes" rows="3" placeholder="What does success look like? What decisions need to be made?"></textarea>
                </div>
                <div class="form-group">
                    <label>Engagement Type</label>
                    <select name="engagement">
                        <option value="project">Project-Based</option>
                        <option value="retainer">Ongoing Retainer</option>
                        <option value="workshop">Workshop/Training</option>
                        <option value="assessment">Initial Assessment</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Timeline</label>
                    <input type="text" name="timeline" placeholder="When do you need advisory support?">
                </div>
                <button type="submit" class="form-submit">Schedule Consultation</button>
            </form>
        </div>
    </div>

    <!-- Modal Popup for Service 3 (Site Selection) -->
    <div class="modal-overlay" id="siteSelectionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2>SITE SELECTION: Expert Consulting</h2>
            <p style="font-size: 14px; line-height: 1.8; margin-bottom: 20px;">
                Our site selection team combines decades of data center industry experience with proprietary market intelligence to identify optimal locations for your facility.
            </p>
            <h3 style="font-size: 16px; margin-bottom: 10px;">What's Included:</h3>
            <ul>
                <li><strong>Power Availability Analysis:</strong> Utility capacity, redundancy, and future scalability assessment</li>
                <li><strong>Connectivity Evaluation:</strong> Fiber networks, carrier hotels, and internet exchange proximity</li>
                <li><strong>Tax Incentive Research:</strong> State/local abatements, sales tax exemptions, and economic development programs</li>
                <li><strong>Risk Assessment:</strong> Natural disaster exposure, seismic zones, flood plains, and climate considerations</li>
                <li><strong>Market Comparisons:</strong> Side-by-side analysis of competing locations with cost projections</li>
                <li><strong>Regulatory Review:</strong> Zoning, permitting timelines, and environmental compliance requirements</li>
            </ul>
            <p style="font-size: 14px; font-style: italic; margin-top: 20px;">
                We've helped clients select sites for over $5B in data center projects across North America.
            </p>
            <button class="modal-btn" onclick="alert('Contact form coming soon! Email: contact@dc-intel.com')">Request Consultation</button>
        </div>
    </div>

</body>
</html>
